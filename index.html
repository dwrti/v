<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù…Ø´ØºÙ„ Ø±ÙˆØ§Ø¨Ø· Magnet Ù…Ø¨Ø§Ø´Ø±</title>
    <style>
        body { font-family: sans-serif; background: #1a1a1a; color: white; text-align: center; padding: 20px; }
        #video-container { margin-top: 20px; background: #000; min-height: 400px; display: flex; align-items: center; justify-content: center; border: 2px dashed #444; }
        video { width: 100%; max-width: 800px; }
        input { width: 80%; padding: 10px; border-radius: 5px; border: none; margin-bottom: 10px; }
        button { padding: 10px 20px; cursor: pointer; background: #2ecc71; border: none; color: white; font-weight: bold; border-radius: 5px; }
        #status { margin: 10px; color: #aaa; font-size: 0.9em; }
    </style>
</head>
<body>

    <h2>Ù…Ø´ØºÙ„ ÙÙŠØ¯ÙŠÙˆ Magnet ğŸš€</h2>
    <input type="text" id="magnetLink" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„Ù€ Magnet Ù‡Ù†Ø§...">
    <br>
    <button onclick="startDownload()">ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</button>
    
    <div id="status">Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø±Ø§Ø¨Ø·...</div>
    
    <div id="video-container">
        </div>

    <script src="https://cdn.jsdelivr.net/npm/webtorrent@latest/webtorrent.min.js"></script>
    
    <script>
        const client = new WebTorrent();
        
        function startDownload() {
            const magnetURI = document.getElementById('magnetLink').value;
            const status = document.getElementById('status');
            const container = document.getElementById('video-container');

            if (!magnetURI) {
                alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙˆØ¶Ø¹ Ø±Ø§Ø¨Ø· Ø£ÙˆÙ„Ø§Ù‹!");
                return;
            }

            status.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ù…ÙˆØ²Ø¹ÙŠÙ† (Peers)... ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±";

            client.add(magnetURI, function (torrent) {
                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£ÙˆÙ„ Ù…Ù„Ù ÙÙŠØ¯ÙŠÙˆ Ø¯Ø§Ø®Ù„ Ø§Ù„ØªÙˆØ±Ù†Øª
                const file = torrent.files.find(function (file) {
                    return file.name.endsWith('.mp4') || file.name.endsWith('.mkv') || file.name.endsWith('.webm');
                });

                if (file) {
                    status.innerText = "Ø¬Ø§Ø±ÙŠ ØªØ´ØºÙŠÙ„: " + file.name;
                    container.innerHTML = ''; // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø­Ø§ÙˆÙŠØ©
                    file.appendTo('#video-container', { autoplay: true, controls: true });
                } else {
                    status.innerText = "Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ù„Ù ÙÙŠØ¯ÙŠÙˆ Ù…Ø¯Ø¹ÙˆÙ….";
                }
            });
        }
    </script>
</body>
</html>
