<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¨Ø« Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ø§Ù„Ù…Ø´ØªØ±Ùƒ</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background-color: #1a1a1a; color: white; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .container { width: 100%; max-width: 800px; text-align: center; }
        video { width: 100%; border-radius: 12px; background: #000; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .admin-panel { margin-top: 30px; background: #2d2d2d; padding: 20px; border-radius: 12px; border: 1px solid #444; width: 100%; }
        input { padding: 12px; border-radius: 6px; border: 1px solid #555; background: #1a1a1a; color: white; width: 70%; margin: 10px 5px; }
        button { padding: 12px 25px; border-radius: 6px; border: none; background: #007bff; color: white; cursor: pointer; font-weight: bold; }
        button:hover { background: #0056b3; }
        #linkControls { display: none; } /* Ù…Ø®ÙÙŠ Ø­ØªÙ‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± */
    </style>
</head>
<body>

    <div class="container">
        <h1>Ù…Ø´ØºÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± ğŸ”´</h1>
        
        <video id="mainPlayer" controls autoplay>
            <source src="" type="video/mp4">
            Ù…ØªØµÙØ­Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„ÙÙŠØ¯ÙŠÙˆ.
        </video>

        <div class="admin-panel">
            <div id="authArea">
                <input type="password" id="passInput" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ù„Ù„Ø¥Ø¯Ø§Ø±Ø©">
                <button onclick="checkAdmin()">Ø¯Ø®ÙˆÙ„</button>
            </div>

            <div id="linkControls">
                <input type="text" id="videoUrlInput" placeholder="Ø¶Ø¹ Ø±Ø§Ø¨Ø· ÙÙŠØ¯ÙŠÙˆ MP4 Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù‡Ù†Ø§">
                <button onclick="updateFirebaseVideo()">ØªØ­Ø¯ÙŠØ« Ù„Ù„Ø¬Ù…ÙŠØ¹</button>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ
        const firebaseConfig = {
            apiKey: "AIzaSyAjTD-OJBUYewp5bqV0iVh4Rxp5zjBsU54",
            authDomain: "videos-5e336.firebaseapp.com",
            databaseURL: "https://videos-5e336-default-rtdb.firebaseio.com",
            projectId: "videos-5e336",
            storageBucket: "videos-5e336.firebasestorage.app",
            messagingSenderId: "300218651134",
            appId: "1:300218651134:web:4bd24df8e555e62828f0af"
        };

        // ØªØ´ØºÙŠÙ„ Firebase
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const videoRef = ref(db, 'currentVideo');

        // 1. Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ù„ØªØºÙŠÙŠØ±Ø§Øª (Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡ ÙŠØ´ØªØºÙ„ Ø¹Ù†Ø¯ Ø£ØµØ¯Ù‚Ø§Ø¦Ùƒ ÙÙˆØ±Ø§Ù‹)
        onValue(videoRef, (snapshot) => {
            const data = snapshot.val();
            if (data && data.url) {
                const video = document.getElementById('mainPlayer');
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø±Ø§Ø¨Ø· Ø¬Ø¯ÙŠØ¯Ø§Ù‹
                if (video.src !== data.url) {
                    video.src = data.url;
                    video.load();
                    video.play();
                }
            }
        });

        // 2. ÙˆØ¸ÙŠÙØ© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¬Ø¯ÙŠØ¯ (Ù„Ùƒ Ø£Ù†Øª ÙƒÙ…Ø¯ÙŠØ±)
        window.updateFirebaseVideo = function() {
            const url = document.getElementById('videoUrlInput').value;
            if (url) {
                set(videoRef, {
                    url: url,
                    timestamp: Date.now()
                }).then(() => alert("ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¹Ù†Ø¯ Ø§Ù„Ø¬Ù…ÙŠØ¹!"));
            }
        };

        // 3. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ù…Ø­Ù„ÙŠØ§Ù‹ (Ù„Ù„Ø¨Ø³Ø§Ø·Ø©)
        window.checkAdmin = function() {
            const pass = document.getElementById('passInput').value;
            if (pass === "1234") { // ØºÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ù‡Ù†Ø§
                document.getElementById('authArea').style.display = 'none';
                document.getElementById('linkControls').style.display = 'block';
            } else {
                alert("Ø®Ø·Ø£!");
            }
        };
    </script>
</body>
</html>
