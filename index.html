// Ø§Ø¨Ø­Ø« Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡ ÙÙŠ Ù‚Ø³Ù… Ø§Ù„Ù€ Script ÙˆØ­Ø¯Ø«Ù‡ Ø£Ùˆ Ø§Ø³ØªØ¨Ø¯Ù„ Ø§Ù„Ø¯Ø§Ù„Ø©
async function syncFromGitHubM3U() {
    // Ø§Ø³ØªØ¨Ø¯Ù„ Ø§Ù„Ø±Ø§Ø¨Ø· Ø£Ø¯Ù†Ø§Ù‡ Ø¨Ø±Ø§Ø¨Ø· Ù…Ù„ÙÙƒ Ø§Ù„Ø®Ø§Ù… (Raw) Ù…Ù† Ø¬ÙŠØª Ù‡Ø§Ø¨
    const githubRawUrl = "https://raw.githubusercontent.com/tfrj/v/main/yourfile.m3u"; 

    try {
        const response = await fetch(githubRawUrl);
        if (!response.ok) throw new Error("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù„Ù");
        
        const data = await response.text();
        const lines = data.split('\n');
        let count = 0;

        for (let i = 0; i < lines.length; i++) {
            const line = lines[i].trim();
            if (line.startsWith('#EXTINF:')) {
                const nameMatch = line.match(/,(.*)$/);
                const name = nameMatch ? nameMatch[1].trim() : "Ù‚Ù†Ø§Ø© Ù…Ø¶Ø§ÙØ©";
                const videoUrl = lines[i + 1] ? lines[i + 1].trim() : null;

                if (videoUrl && videoUrl.startsWith('http')) {
                    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹ Ù„ØªØ¬Ù†Ø¨ Ø§Ù„ØªÙƒØ±Ø§Ø±
                    tapesRef.push({
                        name: "ğŸ”— " + name,
                        url: videoUrl,
                        timestamp: Date.now()
                    });
                    count++;
                }
            }
        }
        console.log(`ØªÙ… Ù…Ø²Ø§Ù…Ù†Ø© ${count} Ù‚Ù†Ø§Ø© Ù…Ù† GitHub`);
    } catch (error) {
        console.error("Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ù…Ù„Ù M3U Ù…Ù† GitHub:", error);
    }
}

// Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ø¹Ù†Ø¯ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø£Ø¯Ù…Ù† ÙÙ‚Ø· (Ø­ØªÙ‰ Ù„Ø§ ÙŠØªÙƒØ±Ø± Ø§Ù„Ø±ÙØ¹ Ù…Ù† ÙƒÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†)
auth.onAuthStateChanged(user => {
    if (user && user.email === "t@t.tt") {
        isAdmin = true;
        // ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ø¨Ù…Ø¬Ø±Ø¯ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø£Ø¯Ù…Ù†
        syncFromGitHubM3U(); 
        
        document.getElementById('authSection').style.display = 'none';
        document.getElementById('adminSection').style.display = 'block';
        syncRef.update({ adminPresent: true });
    }
});
